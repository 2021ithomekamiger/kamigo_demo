<%= raw (Kamiflex.json(self) do
  alt_text "LINE Flex Message Showcase: TODO App"

  carousel do
    @todos.each do |todo|
      bubble size: :nano do
        header backgroundColor: todo.background_color, paddingTop: "19px", paddingAll: "12px", paddingBottom: "16px" do
          text todo.state, color: "#ffffff", align: :start, size: :md, gravity: :center
          text todo.percentage, color: "#ffffff", align: :start, size: :xs, gravity: :center, margin: :lg
          vertical_box backgroundColor: "#9FD8E36E", height: "6px", margin: :sm do
            vertical_box width: todo.percentage, backgroundColor: todo.state_color, height: "6px" do
              filler
            end
          end
        end
        body spacing: :md, paddingAll: "12px" do
          horizontal_box flex: 1 do
            text todo.statement, color: "#8C8C8C", size: :sm, wrap: true
          end
        end
        styles footer: { separator: false }
      end
    end
  end
end) %>