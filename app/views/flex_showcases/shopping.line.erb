<%= raw (Kamiflex.json(self) do
  alt_text "LINE Flex Message Showcase: Shopping"

  carousel do
    bubbles @products.first(2) do |product|
      hero product.image, size: :full, aspectRatio: "20:13", aspectMode: :cover
      body spacing: :sm do
        text product.name, wrap: true, weight: :bold, size: :xl
        shopping_price product.price
        unless product.inventory
          text "Temporarily out of stock", wrap: true, size: :xxs, margin: :md, color: "#ff5551", flex: 0
        end
      end
      footer do
        color = product.inventory ? "#00c300" : "#aaaaaa"
        url_button "Add to Cart", "https://linecorp.com", style: :primary, color: color
        url_button "Add to wishlist", "https://linecorp.com"
      end
    end
    if @products.length > 2
      bubble do
        body do
          url_button "See more", "https://linecorp.com", flex: 1, gravity: :center
        end
      end
    end
  end
end) %>